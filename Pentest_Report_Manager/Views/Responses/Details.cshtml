@model ProjectSupport.Core.Models.TaskResponse






<style>

    .replycolor {
        background: rgb(255,255,255);
        background: linear-gradient(90deg, rgba(255,255,255,0) 44%, rgba(208,191,144,1) 92%);
    }
</style>






    <!-- Card -->
    <div class="card promoting-card mb-3">

        

        <!-- Card Header -->
        <div class="row  mx-1">
            <div class="col-12 col-md-5 p-3 text-left">

                <!-- Title -->
                <p class="text-left ml-3 mb-0 mt-1" style="font-size:18px;">
                    <strong class="mt-1 mr-1 ml-n3" style="font-weight:normal; color: rgba(0,0,0,.4);">v@(Model.ReportVersion):</strong>
                    @Html.DisplayFor(m => Model.Title)
                </p>
                
            </div>

            <!-- User and Date -->
            <div class="col-12 col-md-7 d-flex pt-2">

                <!-- tabs titles -->
                <ul class="nav sm-pills pills-light-blue mt-1">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#panelH_@Model.ID" role="tab">Detail</a>
                    </li>
                    @{
                        var vulnerabilitiesCount = Model.High_Vulnerabilities_Count + Model.Medium_Vulnerabilities_Count + Model.Low_Vulnerabilities_Count;
                        if (vulnerabilitiesCount > 0)
                        {
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#panelM_@Model.ID" role="tab">Vulnerabilities</a>
                            </li>
                        }
                    }
                    @if (Model.Attachments.Count > 0)
                    {
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#panelL_@Model.ID" role="tab">Attachments</a>
                        </li>
                    }
                </ul>

                <!-- Avatar -->
                @*<img src="https://mdbootstrap.com/img/Photos/Avatars/avatar-8.jpg" class="rounded-circle mr-3" height="50px" width="50px" alt="avatar" />*@
                <i class="fas fa-user-circle mt-1 mr-2 ml-auto" style="font-size: 35px;" alt="avatar"></i>

                <!-- Content -->
                <div class="mr-3">
                    <!-- User -->
                    <div class="card-title  mb-0" style="font-size:15px;">@Model.Submitter_ApplicationUser.FullName</div>

                    <!-- Subtitle -->
                    <p class="card-text" style="font-size:12px;">@(Model.CreationDateTime_in_PersianDate)</p>

                </div>

                <div class="three-dot-setting ml-2">
                    <div class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                         aria-expanded="false" style="padding-top: 16px;">
                        <i class="fas fa-ellipsis-v menu-three-dot" style="line-height:48px;"></i>
                        <style>
                            div.dropdown-toggle::after {
                                display: none !important;
                            }

                            .dropdown-toggle .menu-three-dot {
                                width: 20px;
                                text-align: center;
                                padding-bottom: 6px;
                            }

                            .three-dot-setting {
                               
                                margin-right: -20px;
                                margin-top: -8px;
                            }
                            .three-dot-setting:hover {
                                background: rgba(0,0,0,0.07);
                                
                            }
                        </style>
                    </div>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="~/Projects/@Model.JobTask.Project_Ref/tasks/@Model.JobTask_Ref/Responses/@Model.ID">Edit</a>
                        <a class="dropdown-item" href="~/Projects/@Model.JobTask.Project_Ref/tasks/@Model.JobTask_Ref/Responses/@Model.ID/delete">Delete</a>
                    </div>
                </div>

            </div>
        </div>
        <hr class="mt-0" />





        <!-- Card content -->
        <div class="card-body2 row " style="padding-left:30px; padding-right:30px;">




            <!-- details -->
            <div class="col-12 text-right " >
                
                <!-- Tab panels -->
                <div class="tab-content pt-0">

                    <!--Panel 1-->
                    <div class="tab-pane fade in show active" id="panelH_@Model.ID" role="tabpanel">


                        <!-- Details -->
                        @if (string.IsNullOrEmpty(Model.Description?.Trim())==false)
                        {
                            <div class="w-100 mb-2">
                                <div class="card-body text-left pt-1">
                                    <h5 class=" mb-0 mt-3 mr-auto d-inline-block">Description</h5>
                                </div>

                                <div class="flex0 mt-n2 border ">
                                    <p class="p-3 mt-0 card-text text-justify  w-100 @Model.Description.GetTextLangDirection() ">
                                        @Html.Raw(Model.Description_Printable)
                                    </p>
                                </div>
                            </div>
                        }

                        <!-- Doc & Pdf File -->
                        <div class="mx-n3 col-12 col-md-6">
                            @{
                                var attachments = new List<Attachment>();
                                if (Model.ReportFileAndPDF.DocFile != null)
                                    attachments.Add(Model.ReportFileAndPDF.DocFile);
                                if (Model.ReportFileAndPDF.PdfFile != null)
                                    attachments.Add(Model.ReportFileAndPDF.PdfFile);


                                var urls = new AttachmentUploadObject(ViewBag.sp)
                                {
                                    Attachments = attachments,
                                    IsMultiple = true,
                                    ParagraphTitle = "Report Files",
                                    AttachmentsIDs_FieldName = "docFileName",
                                    IsReadOnly = true
                                };
                            }
                            <partial name="~/Views/Shared/Partials/Attachment/AttachmentLoader.cshtml" for="@urls" />
                        </div>


                    </div>
                    <!--/.Panel 1-->
                    <!--Panel 2-->
                    <div class="tab-pane fade" id="panelM_@Model.ID" role="tabpanel">

                        <style>
                            .list-group li.list-group-item {
                                border: none;
                            }
                        </style>
                        @if (Model.Vulnerablities_Titles.Any(v => v.Label == "H"))
                        {
                            <h5 class="mt-3 red-text">Critical/High Vulnerabilities</h5>
                            <hr />
                            <ul class="list-group list-group-flush ">
                                @foreach (var vul_string in Model.Vulnerablities_Titles.Where(v => v.Label == "H").ToList())
                                {
                                    <li class="list-group-item" style="text-align: right; direction: rtl;">
                                        <i class="fas fa-exclamation-circle red-text"></i>
                                        <p class="d-inline pr-3">@vul_string.Text</p>
                                    </li>
                                }
                            </ul>
                        }
                        @if (Model.Vulnerablities_Titles.Any(v => v.Label == "M"))
                        {
                            <h5 class="mt-4 orange-ic">Medium Vulnerabilities</h5>
                            <hr />
                            <ul class="list-group list-group-flush ">
                                @foreach (var vul_string in Model.Vulnerablities_Titles.Where(v => v.Label == "M").ToList())
                                {
                                    <li class="list-group-item" style="text-align: right; direction: rtl;">
                                        <i class="fas fa-exclamation-triangle orange-ic"></i>
                                        <p class="d-inline pr-3">@vul_string.Text</p>
                                    </li>
                                }
                            </ul>
                        }
                        @if (Model.Vulnerablities_Titles.Any(v => v.Label == "L")) { 
                            <h5 class="mt-4 blue-text">Low Vulnerabilities</h5>
                            <hr />
                            <ul class="list-group list-group-flush ">
                                @foreach (var vul_string in Model.Vulnerablities_Titles.Where(v => v.Label == "L").ToList())
                                {
                                    <li class="list-group-item" style="text-align: right; direction: rtl;">
                                        <i class="fas fa-info-circle blue-text "></i>
                                        <p class="d-inline pr-3">@vul_string.Text</p>
                                    </li>
                                }
                            </ul>
                        }
                    <br />
                    </div>
                    <!--/.Panel 2-->
                    <!--Panel 3-->
                    <div class="tab-pane fade " id="panelL_@Model.ID" role="tabpanel">
                        @if (Model.Attachments.Count > 0)
                        {
                            <div class="col-12">
                                @{
                                    var urls3 = new AttachmentUploadObject(ViewBag.sp)
                                    {
                                        Attachments = Model.Attachments,
                                        ParagraphTitle = "Attachments",
                                        AttachmentsIDs_FieldName = "allAttachments",
                                        Do_not_insert_formId_and_Mac_inputs = true,
                                        IsReadOnly = true,
                                        ShowTitle=false
                                    };
                                }
                                <partial name="~/Views/Shared/Partials/Attachment/AttachmentLoader.cshtml" for="@urls3" />
                            </div>
                        }
                    </div>
                    <!--/.Panel 3-->


                </div>

            </div>
            <!-- slider end-->


        </div>

    </div>
    <!-- Card -->


