@model ProjectSupport.Core.Models.Project

@{
    ViewData["Title"] = "Details";
}




                                    
<style>

    @@media screen and (max-width: 800px) {
        #navigationTitle {
            position: relative !important;
            
            z-index: 3 !important;
            margin-left: 1rem !important;
            
            padding: 15px !important;
            font-size: 18px !important;
            display: inline-block !important;
            
            padding-right:3rem !important;
        }



        #tabNavInfoComment {
            padding-top: 45px !important;
            background-color: blue;
            margin-top: -63px !important;
        }
            #tabNavInfoComment > #navigationTitleInside {
                display:none !important;
                
            }
    }



    #tabNavInfoComment {
        background-color: #EFF0F2 !important;
    }
        #tabNavInfoComment > #navigationTitleInside {
            font-size: 18px !important;
            margin-top: 5px;
            min-width:30% !important;
            max-width:60%;
        }
    #tabNavInfoComment > li >a  {
        color: black !important;
        font-size:14px;
    }


    #panel1 div[class|="paragraph-with-Definition"] {
        margin-top:10px;
    }

                                    </style>



<!-- Nav tabs -->
<h5 id="navigationTitle" class="text-left w-100 d-none text-truncate ">
    @Html.DisplayFor(model => model.ProjectName) 
</h5>
<ul id="tabNavInfoComment" class="nav nav-tabs md-tabs nav-justified @*primary-color*@ site-theme-topNav-gradient " role="tablist">

    <li id="navigationTitleInside" class="d-inline-block text-left mr-5 text-truncate">
        @Html.DisplayFor(model => model.ProjectName) 
    </li>

    <li class="nav-item">
        <a class="nav-link active" data-toggle="tab" href="#Details" role="tab">
            <i class="fas fa-info-circle pr-2"></i>Details
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#tasks" role="tab">
            <i class="fas fa-tasks pr-2"></i>Tasks
        </a>
    </li>
    <li class="nav-item" id="ddddd">
        <a class="nav-link" data-toggle="tab" href="#comments" role="tab">
            <i class="far fa-comments pr-2"></i>Comments
        </a>
    </li>
</ul>
<!-- Nav tabs -->

<!-- Tab panels -->
<div class="tab-content card">

    <!-- Panel Info -->
    <div class="tab-pane fade in show active" id="Details" role="tabpanel">



        <hr class="mt-1 mb-0">

        <p class="pt-2 card-text text-justify @*text-truncate*@ text-center @Model.Description.GetTextLangDirection() ">
            @Html.Raw(Model.Description_Printable)
        </p>



        @Html.Partial("_MultiColumn_for_General_2Columns-Start", "DetailsFields")

        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.PolicyName)
            </strong>
            @Html.DisplayFor(model => model.PolicyName)
        </div>
        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.AdomName)
            </strong>
            @Html.DisplayFor(model => model.AdomName)
        </div>
        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.URL)
            </strong>
            @Html.DisplayFor(model => model.URL)
        </div>
        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.ServerPool)
            </strong>
            @Html.DisplayFor(model => model.ServerPool)
        </div>
        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.VirtualIP)
            </strong>
            @Html.DisplayFor(model => model.VirtualIP)
        </div>
        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.Owner)
            </strong>
            @Html.DisplayFor(model => model.Owner)
        </div>

        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.Priority)
            </strong>
            @Html.DisplayFor(model => model.Priority)
        </div>

        @Html.Partial("_MultiColumn_for_General_2Columns-End", "DetailsFields")

        @*<div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.Last_Modification_DateTime)
            </strong>
            @Html.DisplayFor(model => model.Last_Modification_DateTime)
        </div>
        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.Modifier_Pentester)
            </strong>
            @Html.DisplayFor(model => model.Modifier_Pentester)
        </div>
        <div class='paragraph-with-Definition-p80-JumpToLeft justify-wrap-break'>
            <strong class='ParagraphTitle font-weight-bold mr-3 d-inline-block text-right'>
                @Html.DisplayNameFor(model => model.SubProjects)
            </strong>
            @Html.DisplayFor(model => model.SubProjects)
        </div>*@


        <hr class="mt-4 mb-0">
        @{
            var urls = new AttachmentUploadObject
            {
                DownloadAction = @"/Attachment/Download/?filename=",
                Attachments = Model.Attachments
            };
        }
        <partial name="AttachmentLoader_ReadOnly" for="@urls" />




        <div class="form-group col-12 mt-4 mb-0 ">
            <a href="~/Projects/Edit/@Model.ID" class="btn btn-outline-primary btn-rounded waves-effect btn-md">Edit</a>
            <a href="~/Projects/index" class="btn btn-outline-default btn-rounded waves-effect btn-md">Back to list</a>
            <a href="~/Projects/Delete/@Model.ID" class="btn btn-outline-danger btn-rounded btn-md waves-effect float-right">
                Delete
                <i class="fas fa-trash-alt ml-1"></i>
            </a>
        </div>

    </div>
    <!-- Panel Info -->
    <!-- Panel Tasks -->
    <div class="tab-pane fade" id="tasks" role="tabpanel">

        <!-- Nav tabs -->
        <div class="row">
            <div class="col-md-4 col-lg-3">
                <ul class="nav md-pills pills-primary flex-column" role="tablist">

                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#tasksList_all" role="tab">
                            All Tasks
                            @{ var tasksList = Model.JobTasks.Where(j => j.IsDeleted == false); }
                            <span class="badge badge-light ml-2 float-right">@tasksList.Count()</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " data-toggle="tab" href="#tasksList_Open" role="tab">
                            Open Tasks
                            <span class="badge badge-light ml-2 float-right">
                                @tasksList.Where(t=> 
                                   t.Status==ProjectSupport.Core.Models.TaskStatus.Defined ||
                                   t.Status==ProjectSupport.Core.Models.TaskStatus.Assigned ||
                                   t.Status==ProjectSupport.Core.Models.TaskStatus.InProgress
                                   ).Count()
                                    </span>
                        </a>
                    </li>
                <li class="nav-item">
                    <a class="nav-link " data-toggle="tab" href="#tasksList_Stopping" role="tab">
                        Stopping Tasks
                        <span class="badge badge-light ml-2 float-right">
                            @tasksList.Where(t=>
                                               t.Status==ProjectSupport.Core.Models.TaskStatus.problem ||
                                               t.Status==ProjectSupport.Core.Models.TaskStatus.Halt ||
                                               t.Status==ProjectSupport.Core.Models.TaskStatus.ReportSent
                                               ).Count()
                        </span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " data-toggle="tab" href="#tasksList_Closed" role="tab">
                        Closed Tasks
                        <span class="badge badge-light ml-2 float-right">@tasksList.Where(t => t.Status == ProjectSupport.Core.Models.TaskStatus.Closed).Count()</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " data-toggle="tab" href="#" role="tab">
                        <a href="~/Tasks/create?ProjectId=@Model.ID" target="_blank" class="btn btn-outline-primary btn-rounded waves-effect btn-md">Create New Task</a>
                    </a>
                </li>
                </ul>
            </div>
            <div class="col-md-8 col-lg-9">
                <!-- Tab panels -->
                <div class="tab-content vertical">
                    <!-- Panel 1 -->
                    <div class="tab-pane fade in show active" id="tasksList_all" role="tabpanel">
                        @{
                            ViewBag.ContainerName = "tasksList_all_container";
                            ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                        }

                        @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList)
                    </div>
                    <!-- Panel 1 -->
                    <!-- Panel 2 -->
                    <div class="tab-pane fade" id="tasksList_Open" role="tabpanel">
                        @{
                            ViewBag.ContainerName = "tasksList_all_Open";
                            ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                        }

                        @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList.Where(t =>
                                                            t.Status == ProjectSupport.Core.Models.TaskStatus.Defined ||
                                                            t.Status == ProjectSupport.Core.Models.TaskStatus.Assigned ||
                                                            t.Status == ProjectSupport.Core.Models.TaskStatus.InProgress))
                    </div>
                    <!-- Panel 2 -->
                    <!-- Panel 3 -->
                    <div class="tab-pane fade" id="tasksList_Stopping" role="tabpanel">
                        @{
                            ViewBag.ContainerName = "tasksList_all_Stopping";
                            ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                        }

                        @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList.Where(t =>
                                                            t.Status == ProjectSupport.Core.Models.TaskStatus.problem ||
                                                            t.Status == ProjectSupport.Core.Models.TaskStatus.Halt||
                                                            t.Status == ProjectSupport.Core.Models.TaskStatus.ReportSent))
                    </div>
                    <!-- Panel 3 -->
                    <!-- Panel 4 -->
                    <div class="tab-pane fade" id="tasksList_Closed" role="tabpanel">
                        @{
                            ViewBag.ContainerName = "tasksList_all_Closed";
                            ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                        }

                        @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList.Where(t => t.Status == ProjectSupport.Core.Models.TaskStatus.Closed))
                    </div>
                    <!-- Panel 5 -->
                </div>
            </div>
        </div>
        <!-- Nav tabs -->

    </div>
    <!-- Panel tasks -->
    <!-- Panel Comments -->
    <div class="tab-pane fade" id="comments" role="tabpanel">
        fasdf


    </div>
    <!-- Panel Comments -->

</div>
<!-- Tab panels -->


<script>


    $(document).ready(function () {
        $('#tabNavInfoComment >li >a').click(function () {
            window.setTimeout(function () {
                triggerResizeEvent();
            }, 700);
        });
        $('#tasks > div.row ul a').click(function () {
            window.setTimeout(function () {
                triggerResizeEvent();
            }, 700);
        });

        var hash = window.location.hash;
        if (hash=="#details")
            //$('#tabNavInfoComment > li a[href="#details"]').tab('show');
            $('#tabNavInfoComment > li a[href="#details"]').click();
        else if (hash == "#tasks")
            //$('#tabNavInfoComment > li a[href="#tasks"]').tab('show');
            $('#tabNavInfoComment > li a[href="#tasks"]').click();
        else if (hash == "#comments")
            //$('#tabNavInfoComment > li a[href="#comments"]').tab('show');
            $('#tabNavInfoComment > li a[href="#comments"]').click();

    });

</script>

