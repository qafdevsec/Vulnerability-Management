@model ProjectSupport.Core.Models.Project

@{
    Layout = "_Navigation_Layout_for_Details.cshtml";
    ViewData["Title"] = "Tasks";
    ViewData["Model"] = Model;
}




<!-- Nav tabs -->
<div class="row projectTasks">
    <div class="col-md-4 col-lg-3">
        <ul class="nav md-pills pills-primary flex-column" role="tablist">

            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#tasksList_all" role="tab">
                    All Tasks
                    @{ var tasksList = Model.JobTasks.Where(j => j.IsDeleted == false).OrderByDescending(j=>j.ID); }
                    <span class="badge badge-light ml-2 float-right">@tasksList.Count()</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link " data-toggle="tab" href="#tasksList_Open" role="tab">
                    Open Tasks
                    <span class="badge badge-light ml-2 float-right">
                        @tasksList.Where(t=>
                           t.Status==ProjectSupport.Core.Models.TaskStatus.Defined ||
                           t.Status==ProjectSupport.Core.Models.TaskStatus.Assigned ||
                           t.Status==ProjectSupport.Core.Models.TaskStatus.InProgress
                           ).Count()
                    </span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link " data-toggle="tab" href="#tasksList_Stopping" role="tab">
                    Stopping Tasks
                    <span class="badge badge-light ml-2 float-right">
                        @tasksList.Where(t=>
                                           t.Status==ProjectSupport.Core.Models.TaskStatus.problem ||
                                           t.Status==ProjectSupport.Core.Models.TaskStatus.Halt ||
                                           t.Status==ProjectSupport.Core.Models.TaskStatus.ReportSent
                                           ).Count()
                    </span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link " data-toggle="tab" href="#tasksList_Closed" role="tab">
                    Closed Tasks
                    <span class="badge badge-light ml-2 float-right">@tasksList.Where(t => t.Status == ProjectSupport.Core.Models.TaskStatus.Closed).Count()</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link " data-toggle="tab" href="#" role="tab">
                    <a href="~/Tasks/create?ProjectId=@Model.ID" class="btn btn-outline-primary btn-rounded waves-effect btn-md">Create New Task</a>
                </a>
            </li>
        </ul>
    </div>
    <div class="col-md-8 col-lg-9">
        <!-- Tab panels -->
        <div class="tab-content vertical">
            <!-- Panel 1 -->
            <div class="tab-pane fade in show active" id="tasksList_all" role="tabpanel">
                @{
                    ViewBag.ContainerName = "tasksList_all_container";
                    ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                }

                @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList)
            </div>
            <!-- Panel 1 -->
            <!-- Panel 2 -->
            <div class="tab-pane fade" id="tasksList_Open" role="tabpanel">
                @{
                    ViewBag.ContainerName = "tasksList_all_Open";
                    ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                }

                @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList.Where(t =>
                                                    t.Status == ProjectSupport.Core.Models.TaskStatus.Defined ||
                                                    t.Status == ProjectSupport.Core.Models.TaskStatus.Assigned ||
                                                    t.Status == ProjectSupport.Core.Models.TaskStatus.InProgress))
            </div>
            <!-- Panel 2 -->
            <!-- Panel 3 -->
            <div class="tab-pane fade" id="tasksList_Stopping" role="tabpanel">
                @{
                    ViewBag.ContainerName = "tasksList_all_Stopping";
                    ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                }

                @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList.Where(t =>
                                                    t.Status == ProjectSupport.Core.Models.TaskStatus.problem ||
                                                    t.Status == ProjectSupport.Core.Models.TaskStatus.Halt||
                                                    t.Status == ProjectSupport.Core.Models.TaskStatus.ReportSent))
            </div>
            <!-- Panel 3 -->
            <!-- Panel 4 -->
            <div class="tab-pane fade" id="tasksList_Closed" role="tabpanel">
                @{
                    ViewBag.ContainerName = "tasksList_all_Closed";
                    ViewBag.viewPath = "~/Views/Tasks/Summary.cshtml";
                }

                @Html.Partial("_MultiColumn_for_SingleEntities-one_or_two", tasksList.Where(t => t.Status == ProjectSupport.Core.Models.TaskStatus.Closed))
            </div>
            <!-- Panel 5 -->
        </div>
    </div>
</div>
<!-- Nav tabs -->




<script>


    $(document).ready(function () {
        
        $('div.projectTasks ul a').click(function () {
            window.setTimeout(function () {
                triggerResizeEvent();
            }, 700);
        });

    });

</script>